<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel Admin</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f8f8f8; }
    h1 { text-align: center; }
    .pc-select { margin: 10px auto; display: block; padding: 10px; }
    .grupo { border: 2px solid #ccc; padding: 15px; margin: 15px 0; border-radius: 8px; background: #fff; }
    .titulo-grupo { font-weight: bold; margin-bottom: 10px; }
    .boton-item { background: #eee; margin: 5px 0; padding: 5px; border-radius: 5px; display: flex; justify-content: space-between; }
    button { margin: 3px; padding: 6px 10px; border: none; border-radius: 5px; cursor: pointer; }
    .btn-add { background: #4CAF50; color: white; }
    .btn-del { background: #f44336; color: white; }
  </style>
</head>
<body>
  <h1>Panel Admin</h1>

  <label for="pc">Seleccionar PC:</label>
  <select id="pc" class="pc-select" onchange="mostrarConfig()">
    <option value="pc1">PC1</option>
    <option value="pc2">PC2</option>
    <option value="pc3">PC3</option>
    <option value="pc4">PC4</option>
    <option value="pc5">PC5</option>
    <option value="pcalv">PCALV</option>
  </select>

  <div id="contenedor"></div>
  <button class="btn-add" onclick="agregarGrupo()">➕ Agregar Grupo</button>

  <script>
    // Datos guardados
    function obtenerConfig() {
      return JSON.parse(localStorage.getItem("config")) || {};
    }

    function guardarConfig(data) {
      localStorage.setItem("config", JSON.stringify(data));
    }

    function mostrarConfig() {
      const pc = document.getElementById("pc").value;
      const data = obtenerConfig();
      const config = data[pc] || { macros: [] };
      const cont = document.getElementById("contenedor");
      cont.innerHTML = "";

      config.macros.forEach((grupo, gi) => {
        const div = document.createElement("div");
        div.className = "grupo";

        const titulo = document.createElement("div");
        titulo.className = "titulo-grupo";
        titulo.textContent = grupo.titulo + " (" + grupo.color + ")";
        div.appendChild(titulo);

        // Botones dentro del grupo
        grupo.botones.forEach((b, bi) => {
          const item = document.createElement("div");
          item.className = "boton-item";
          item.innerHTML = `<span>${b.texto} → ${b.mensaje}</span>`;
          const btnDel = document.createElement("button");
          btnDel.textContent = "🗑️";
          btnDel.className = "btn-del";
          btnDel.onclick = () => {
            grupo.botones.splice(bi, 1);
            data[pc] = config;
            guardarConfig(data);
            mostrarConfig();
          };
          item.appendChild(btnDel);
          div.appendChild(item);
        });

        // Botón para agregar nuevo botón en este grupo
        const btnAdd = document.createElement("button");
        btnAdd.textContent = "➕ Agregar Botón";
        btnAdd.className = "btn-add";
        btnAdd.onclick = () => {
          const texto = prompt("Texto del botón:");
          if (!texto) return;
          const mensaje = prompt("Mensaje a copiar:");
          if (!mensaje) return;
          grupo.botones.push({ texto, mensaje });
          data[pc] = config;
          guardarConfig(data);
          mostrarConfig();
        };
        div.appendChild(btnAdd);

        // Botón para eliminar todo el grupo
        const btnDelGrupo = document.createElement("button");
        btnDelGrupo.textContent = "🗑️ Eliminar Grupo";
        btnDelGrupo.className = "btn-del";
        btnDelGrupo.onclick = () => {
          config.macros.splice(gi, 1);
          data[pc] = config;
          guardarConfig(data);
          mostrarConfig();
        };
        div.appendChild(btnDelGrupo);

        cont.appendChild(div);
      });
    }

    function agregarGrupo() {
      const pc = document.getElementById("pc").value;
      const data = obtenerConfig();
      if (!data[pc]) data[pc] = { macros: [] };
      const titulo = prompt("Título del grupo:");
      if (!titulo) return;
      const color = prompt("Color en HEX (ej: #2196F3):", "#2196F3");
      data[pc].macros.push({ titulo, color, botones: [] });
      guardarConfig(data);
      mostrarConfig();
    }

    // Mostrar al cargar
    mostrarConfig();
  </script>
</body>
</html>
